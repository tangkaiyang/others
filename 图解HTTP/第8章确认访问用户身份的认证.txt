第8章确认访问用户身份的认证
8.1 何为认证
密码:只有本人才会知道的字符串信息
动态令牌:仅限本人持有的设备内显示的一次性密码
数字证书:仅限本人(终端)持有的信息
生物认证:指纹和虹膜等本人的生理信息
IC卡等:仅限本人持有的信息

HTTP使用的认证方式:
BASIC认证(基本认证)
DIGEST认证(摘要认证)
SSL客户端认证
FormBase认证(基于表单认证)
此外,还有Windows统一认证(Keberos认证,NTLM认证)
8.2 BASIC认证
Web服务器与通信客户端之间进行的认证方式
步骤1:当请求的资源需要BASIC认证时,服务器会随状态码401 Authorization Required,返回带WWW-Authenticate首部字段的响应.
该字段内包含认证的方式(BASIC)及Request-URI安全域字符串(realm)
步骤2:接收到状态码401的客户端为了通过BASIC认证,需要将用户ID和密码发送给服务器.冒号:连接,经过Base64编码处理
步骤3:接收到包含首部字段Authorization请求的服务器,会对认证信息的正确性进行验证.通过则返回一条包含Request-URI资源的响应
被盗可能性极高;一般的浏览器无法实现认证注销操作;不常用
8.3 DIGEST认证
使用质询/响应的方式(challenge/response),不会像BASIC认证那样直接发送明文密码
所谓质询响应方式:一开始乙方会先发送认证要求给另一方,接着使用从另一方那接受到的质询码计算生成响应码.最后将响应码返回给对方进行认证的方式.
步骤1:请求需认证的资源时,服务器会随着状态码401 Authorization Required,返回带WWW-Authenticate首部字段的响应.
该字段内包含质询响应方式认证所需的临时质询码(随机数,nonce).
首部字段WWW-Authenticate内必须包含realm和nonce这两个字段的信息.客户端就是依靠向服务器回送这两个值进行认证的.
步骤2:接收到401状态码的客户端,返回的响应中包含DIGEST认证必须的首部字段Authorization信息.
首部字段Authorization内必须包含username,realm,nonce,uri和response的字段信息.realm和nonce就是之前从服务器接收到的响应中的字段
步骤3:接收到包含首部字段Authorization请求的服务器,会确认认证信息的正确性.认证通过则返回包含Request-URI资源的响应
8.4 SSL客户端认证
SSL客户端认证可以避免用户ID和密码被盗的情况下的意外发生
SSL客户端认证是借由HTTPS的客户端证书完成认证的方式.凭借客户端证书认证,服务器可确认访问是否来自自己登录的客户端.
8.4.1 SSL客户端认证的认证步骤
客户端必须安装客户端证书
步骤1:接收到需要认证资源的请求,服务器会发送Certificate Request报文,要求客户端提供客户端证书
步骤2:用户选择将发送的客户端证书后,客户端会把客户端证书信息以Client Certificate报文方式发送给服务器
步骤3:服务器验证客户端证书验证通过后三方可领取证书内客户端的公开密钥,然后开始HTTPS加密请求
8.4.2 SSL客户端认证采用双因素认证
证书和基于表单认证组合形成一种双因素认证(Two-factor-authentication)来使用.
8.4.3 SSL客户端认证必要的费用

8.5 基于表单认证
不是HTTP协议中定义的.
客户端会向服务器上的Web应用程序发送登录信息(Credential),按登录信息的验证结果认证
8.5.1 认证多半为基于表单认证
8.5.2 Session管理及Cookie应用
基于表单认证的规范尚未有定论,一般会使用Cookie来管理Session(会话)
基于表单认证本身是通过服务器端的Web应用,将客户端发送过来的用户ID和密码与之前登录过的信息做匹配来进行认证的.
但鉴于HTTP是无状态协议,无法实现状态管理,使用Cookie来管理Session,以弥补HTTP协议中不存在的状态管理功能.
步骤1:客户端把用户ID和密码等登录信息放入报文的实体部分,通常是以POST方法把请求发送给服务器.而这时,会使用HTTPS通信来进行HTML表单画面的显示和用户输入数据的发送
步骤2:服务器会发放用以识别用户的SessionID.通过验证从客户端发送过来的登录信息进行身份认证,然后把用户的认证状态与SessionID绑定后记录在服务器端
步骤3:客户端接收到从服务器端发过来的SessionID后,会将其作为Cookie保存在本地.下次向服务器发送请求时,浏览器会自动发送Cookie,所以SessionID也随之发送到服务器.服务器端可通过验证接收到的SessionID识别用户和其认证状态
